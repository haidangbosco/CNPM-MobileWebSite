{% extends 'mobile_sale_app/base.html' %}
{% load staticfiles %}
{% load humanize %}
{% block body %}
    <div class="adv">
        <div class="container">
            <div class="row">
                <div class="col-md-12">

                    <div class="breadcrumb clearfix">
                        <ul>
                            <li itemtype="http://data-vocabulary.org/Breadcrumb" itemscope="" class="home">
                                <a title="Đến trang chủ" href="/" itemprop="url"><span itemprop="title">Trang chủ</span></a>
                            </li>
                            <li class="icon-li"><strong>Thanh toán</strong></li>
                        </ul>
                    </div>
                    <div class="main">
                        <div class="container">
                            <div class="row">
                                <div class="col-md-12">
                                    <div class="payment-content">
                                        <h1 class="title"><span>Thanh toán</span></h1>
                                        <div class="payment-title text-center">
                                            <h3>
                                                GIAO HÀNG TOÀN QUỐC - THANH TOÁN KHI NHẬN HÀNG - 15 NGÀY ĐỔI TRẢ MIỄN
                                                PHÍ
                                            </h3>
                                            <div>
                                                Nếu gặp khó khăn trong việc đặt hàng xin hãy gọi<b class="hotline">
                                                0908770095 </b>
                                                để được hỗ trợ tốt nhất.
                                            </div>
                                        </div>
                                        <form id="payment-form" class="payment-block clearfix" id="checkout-container" method="post" action="{% url 'mobile_sale_app:payment' pd_id=product.id %}">
                                            {% csrf_token %}
                                            <div class="col-md-4 col-sm-12 col-xs-12 payment-step step2">
                                                <h4>1. Địa chỉ thanh toán và giao hàng</h4>
                                                <div class="step-preview clearfix">
                                                    <h2 class="title">Thông tin thanh toán</h2>
{#                                                    <div class="info-user">#}
{#                                                        <label>Người nhận:<span></span></label>#}
{#                                                        <label>Điện thoại:<span></span></label>#}
{#                                                        <label>Email:<span></span></label>#}
{#                                                        <label>Địa chỉ:<span></span></label>#}
{#                                                        <label>Quận/Huyện:<span></span></label>#}
{#                                                        <label>Thành Phố:<span></span></label>#}
{#                                                        <div class="edit-button">#}
{#                                                            <a href=""><i#}
{#                                                                    class="fa fa-pencil-square-o"></i></a>#}
{#                                                        </div>#}
{#                                                    </div>#}
                                                    <div class="form-block">
                                                        <div class="user-login">
                                                            <a href="{% url 'mobile_sale_app:sign_up' %}">Đăng ký tài
                                                            khoản mua hàng</a>
                                                            <a href="{% url 'mobile_sale_app:log_in' %}">Đăng nhập</a>
                                                        </div>
                                                        <label>Mua hàng không cần tài khoản</label>
                                                        <div class="form-group">
                                                            <label for="id_customer_name">Họ và tên</label>
                                                            {{ payment_form.customer_name }}
                                                            <span id="name" class="help-block hidden">Vui lòng điền họ và tên</span>
                                                        </div>
                                                        <div class="form-group">
                                                            <label for="id_phone_no">Số điện thoại</label>
                                                            {{ payment_form.phone_no }}
                                                            <span id="phone" class="help-block hidden">Vui lòng điền SDT</span>
                                                        </div>
                                                        <div class="form-group">
                                                            <label for="id_email">Email</label>
                                                            {{ payment_form.email }}
                                                            <span id="email" class="help-block hidden">Vui lòng điền Email</span>

                                                        </div>
                                                        <div class="form-group">
                                                            <label for="id_customer_address">Địa chỉ</label>
                                                            {{ payment_form.customer_address }}
                                                            <span id="address" class="help-block hidden">Vui lòng điền địa chỉ</span>
                                                        </div>
                                                         <div class="form-group">
                                                             <label for="id_delivery_to">Địa chỉ nhận hàng</label>
                                                            {{ payment_form.deliver_to }}
                                                            <span id="phone" class="help-block hidden">Vui lòng điền địa chỉ nhận hàng</span>
                                                        </div>
                                                        <div class="form-group">
                                                            {{ payment_form.note }}
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-md-4 col-sm-12 col-xs-12 payment-step step3">
                                                <h4>2. Thanh toán và vận chuyển</h4>
                                                <div class="step-preview clearfix">
                                                    <h2 class="title">Vận chuyển</h2>
                                                    <div class="form-group ">
                                                        {{ payment_form.kind_delivery }}
                                                    </div>
                                                    <h2 class="title">Thanh toán</h2>
                                                    <div class="radio">
                                                        <label>
                                                            **Thanh toán khi nhận hàng
                                                        </label>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-md-4 col-sm-12 col-xs-12 payment-step step1">
                                                <h4>3. Thông tin đơn hàng</h4>
                                                <div class="step-preview">
                                                    <div class="cart-info">
                                                        <div class="cart-items">
                                                            <div class="cart-item clearfix">
                                                                <span class="image pull-left" style="margin-right:10px;">
                                                                    <a href="{% url 'mobile_sale_app:product_detail' pk=product.pk %}">
                                                                        <img src="../../../media/{{ product.img }}" class="img-responsive"/>
                                                                    </a>
                                                                </span>
                                                                <div class="product-info pull-left">
                                                                    <span class="product-name">
                                                                        <a href="{% url 'mobile_sale_app:product_detail' pk=product.pk %}">{{ product.name }}</a> x <span>1</span>
                                                                    </span>
                                                                </div>
                                                                {% if product.sale.type %}
                                                                    <span class="price">{{ product.price_sale| intcomma}} ₫</span>
                                                                {% else %}
                                                                    <span class="price">{{ product.price | intcomma}} ₫</span>
                                                                {% endif %}
                                                            </div>
                                                        </div>
                                                        <div class="shiping-price">
                                                            Phí vận chuyển <label id="id_delivery_charge">20,000 ₫</label>
                                                        </div>
                                                        <div class="total-payment">
                                                            Thanh toán <span id="id_total">0 ₫</span>
                                                            <script type="text/javascript">
                                                                function total_price() {
                                                                    {% if product.sale.type %}
                                                                        price = {{ product.price_sale }}
                                                                    {% else %}
                                                                        price = {{ product.price }}
                                                                    {% endif %}
                                                                    kind_delivery = $('#id_kind_delivery').val();
                                                                    console.log(kind_delivery);
                                                                    if (kind_delivery == 'F')
                                                                        charge = 20000;
                                                                    else
                                                                        charge = 0;
                                                                    total = price + charge;
                                                                    result = total.toString().replace(/(\d)(?=(\d\d\d)+(?!\d))/g, "$1,");
                                                                    $('#id_total').html(result);
                                                                }
                                                                total_price();
                                                                $('#id_kind_delivery').on('change', function () {
                                                                    total_price();
                                                                });
                                                            </script>
                                                        </div>
                                                        <div class="button-submit">
                                                            <button class="btn btn-default" type="submit">Đặt hàng
                                                            </button>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
{% endblock %}